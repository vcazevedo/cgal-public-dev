Handling the case when solver fails.
More tests for correctness.
